jop<-read.csv("C:/Users/Lee seohyun/Desktop/jop.csv")
x<-jop[,1:3]
y<-jop[,4:6]
n<-dim(jop)[1]

----------
  #정준계수
  
>cc(x,y)
$cor #정준상관계수
[1] 0.9194120 0.4186491 0.1133658

$names
$names$Xnames
[1] "x_1" "x_2" "x_3"

$names$Ynames
[1] "y_1" "y_2" "y_3"

$names$ind.names
[1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10"
[11] "11" "12" "13" "14"


$xcoef #정준계수(alpha)
[,1]         [,2]        [,3]
x_1  0.004300092  0.031408316 -0.03519517
x_2 -0.020110886 -0.028134366 -0.01528254
x_3 -0.053120964  0.006447336  0.05245086
#alpha1,(v1)  a2,(v2)       a3,(v3)
#v1=0004x1 -0.02x2 -0.05x3 (정준변수)
$ycoef #beta
[,1]         [,2]        [,3]
y_1 -0.01483783 -0.026536591 -0.05099320
y_2 -0.02525192  0.004197075  0.02920936
y_3 -0.02434304  0.441592020 -0.15072041
#    w1          w2           w3
$scores #정준점수 
$scores$xscores #v1,v2,v3 의 관측값 #정준변수 
[,1]        [,2]        [,3]
[1,]  0.6910075 -0.24753813  1.30395148
[2,] -0.4294875  1.94689629 -0.29742452
[3,] -0.2002147  0.60162391 -1.90263551
[4,] -1.7207486  0.38733927 -0.79201009
[5,] -1.9587746 -1.11371200  0.79640276
[6,]  0.2413628 -0.01569852  0.73401969
[7,]  0.4162770  1.14313523 -0.51772397
[8,]  1.7116840 -0.20634748 -0.12295248
[9,]  0.7496878  0.41858441  0.46389744
[10,] -0.3758432  0.20531361  1.84958388
[11,]  0.7668882  0.54421768  0.32311675
[12,]  0.3829793 -1.72129981 -1.00805035
[13,] -0.7942734 -0.38674690  0.03570236
[14,]  0.5194554 -1.55576756 -0.86587741

$scores$yscores #w1,w2,w3 의 관측값 
[,1]        [,2]        [,3]
[1,]  0.30025201  1.26830815 -1.56061971
[2,] -0.78011722  0.83380716  0.66022790
[3,] -0.13342942 -0.23076870 -2.33696880
[4,] -1.80096474 -0.39115672 -0.22922124
[5,] -1.52190311 -0.08950593  0.26585967
[6,]  0.89068180 -0.40599358 -1.11912867
[7,]  0.55507624  2.41506742  0.93903239
[8,]  1.17429769 -1.15671293  0.52072712
[9,]  1.02043136  0.70605322  0.18766252
[10,] -0.89398956 -0.92394851  0.23807926
[11,]  1.31382851 -1.00588754  0.76826758
[12,]  0.48612395 -0.86581166  0.52446452
[13,] -0.66166574  0.02603581  1.08543894
[14,]  0.05137824 -0.17948620  0.05617854
#정준적재(이 밑)
$scores$corr.X.xscores #x와 정준변수들의 점수값으로 corr계산 
[,1]       [,2]       [,3]      #corr(x1,v1)
x_1 -0.4863184  0.6591844 -0.5735594  #x1과 v1은 0.48만큼 관련이 있다. 
x_2 -0.6215686 -0.5452117 -0.5624915
x_3 -0.8459188  0.4450690  0.2938283
#교차적재
$scores$corr.Y.xscores #corr(yi,vj)
[,1]        [,2]        [,3]
y_1 -0.6894795 -0.10480386 -0.06941846
y_2 -0.8867213  0.01515053  0.02967896
y_3 -0.2641769  0.36897740 -0.04251718
#r교차적재 
$scores$corr.X.yscores #corr(xi,wj)
[,1]       [,2]        [,3]
x_1 -0.4471269  0.2759670 -0.06502204
x_2 -0.5714777 -0.2282524 -0.06376731
x_3 -0.7777478  0.1863277  0.03331009
#정준적재
$scores$corr.Y.yscores  
[,1]       [,2]       [,3]
y_1 -0.7499135 -0.2503382 -0.6123402   #corr(y1,w1)=-0.749
y_2 -0.9644439  0.0361891  0.2617981
y_3 -0.2873325  0.8813524 -0.3750441


>cc(scale(x),scale(y)) #상관계수행렬 -> 표준화된 정준계수(정준계수는 달라지지만 정준상관계수는 같음)
----------------------------------------
  #정준점수
  
  > x[1,]
x_1 x_2 x_3
1  10  11  70
> colMeans(x) #표본평균
x_1      x_2      x_3 
42.14286 39.21429 74.92857 

>as.matrix(x[1,]-colMeans(x))  #표준화 
x_1       x_2       x_3
1 -32.14286 -28.21429 -4.928571
> ccr<-cc(x,y)
> ccr$xcoef
[,1]         [,2]        [,3]
x_1  0.004300092  0.031408316 -0.03519517
x_2 -0.020110886 -0.028134366 -0.01528254
x_3 -0.053120964  0.006447336  0.05245086

> as.matrix(x[1,]-colMeans(x))%*%ccr$xcoef  #표준화 변환 후 정준점수 (v1,v2,v3관측값)
[,1]       [,2]     [,3]
1 0.6910075 -0.2475381 1.303951

> scale(x,center=T,scale=F) #centering변환한 #중심화 변환 
> scale(x,center=T,scale=F)%*%ccr$xcoef  #$scores$xscores와 동일한 결과(위cc함수) #정준변수(v)
-------------------------
  #공헌도
  > ccr<-cc(x,y)
> ccr$scores$corr.X.xscores
> ccr$scores$corr.X.xscores^2
> colSums(ccr$scores$corr.X.xscores^2)

> colSums(ccr$scores$corr.X.xscores^2)/3  #공헌도 
[1] 0.4461439 0.3099554 0.2439007 #v1,v2,v3에 대한 공헌도 

#누적공헌도
> cumsum(colSums(ccr$scores$corr.X.xscores^2)/3)    #p=3
[1] 0.4461439 0.7560993 1.0000000

#y에 대한 공헌도, 누적공헌도 
> colSums(ccr$scores$corr.Y.yscores^2)/3      #q=3 

> cumsum(colSums(ccr$scores$corr.Y.yscores^2)/3)

---------
  #근사도 
> ccr$cor #정준상관계수
> ccr$cor^2 
> cumsum(ccr$cor^2)  #누적값
> cumsum(ccr$cor^2)/sum(ccr$cor^2) #근사도 
[1] 0.8179678 0.9875640 1.0000000  #0.8이므로 정준상관계수 1개정도로 해도 괜찮음

------------
  #독립성 검정
library(candisc)
cancor(x,y)
summary(cancor(x,y))

